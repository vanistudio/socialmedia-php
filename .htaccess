#SECURITY
<Files ~ "^(\.htaccess|\.env)">
    Deny from all
</Files>

Options -Indexes
Header always append X-Frame-Options SAMEORIGIN
Header set X-XSS-Protection "1; mode=block"
Header set X-Content-Type-Options nosniff
Header set X-CSRF-Protection "1; mode=block"

RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f

RewriteRule ^home$ views/contents/_application/AppHome.php [L]
RewriteRule ^$ views/contents/_application/AppHome.php [L]

RewriteRule ^login$ views/contents/_authentication/AuthLogin.php [L]
RewriteRule ^register$ views/contents/_authentication/AuthRegister.php [L]
RewriteRule ^logout$ views/contents/_authentication/AuthLogout.php [L]

RewriteRule ^api/controller/auth$ controllers/_authentication/AuthController.php [L]
RewriteRule ^api/controller/app$ controllers/_application/AppController.php [L]
RewriteRule ^api/controller/upload$ controllers/_application/UploadController.php [L]
RewriteRule ^api/controller/admin$ controllers/_administrator/AdController.php [L]

# Profile page: /u/{username}
RewriteRule ^u/([^/]+)$ views/contents/_application/AppProfile.php?username=$1 [L,QSA]

# Post page: /post/{id}
RewriteRule ^post/([0-9]+)$ views/contents/_application/AppPost.php?id=$1 [L,QSA]

# Settings page: /settings
RewriteRule ^settings$ views/contents/_application/AppSetting.php [L,QSA]

# Messages page: /messages
RewriteRule ^messages$ views/contents/_application/AppMessages.php [L,QSA]

# Notifications page: /notifications
RewriteRule ^notifications$ views/contents/_application/AppNotifications.php [L,QSA]

# Explore page: /explore
RewriteRule ^explore$ views/contents/_application/AppExplore.php [L,QSA]

# Forgot password page: /forgot-password
RewriteRule ^forgot-password$ views/contents/_authentication/AuthForgotPassword.php [L]

# Static pages
RewriteRule ^terms$ views/contents/_application/AppTerms.php [L]
RewriteRule ^privacy$ views/contents/_application/AppPrivacy.php [L]
RewriteRule ^about$ views/contents/_application/AppAbout.php [L]

# ==================== ADMIN ROUTES ====================
# Admin dashboard: /admin
RewriteRule ^admin$ views/contents/_administrator/AdDashboard.php [L,QSA]

# Admin moderation: /admin/moderation
RewriteRule ^admin/moderation$ views/contents/_administrator/AdModeration.php [L,QSA]

# Admin blacklist: /admin/blacklist
RewriteRule ^admin/blacklist$ views/contents/_administrator/AdBlacklist.php [L,QSA]

# Admin reports: /admin/reports
RewriteRule ^admin/reports$ views/contents/_administrator/AdReports.php [L,QSA]

# Admin users: /admin/users
RewriteRule ^admin/users$ views/contents/_administrator/AdUsers.php [L,QSA]

# Admin settings: /admin/settings
RewriteRule ^admin/settings$ views/contents/_administrator/AdSettings.php [L,QSA]
